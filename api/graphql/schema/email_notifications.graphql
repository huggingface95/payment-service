"""
Шаблоны электронной почты
Banking-> Email Notifications
"""
type EmailNotification {
    id: ID!
    "Тип"
    type: String
    "Получить templates"
    templates: [EmailTemplate] @belongsToMany(relation: "templates")
    "Получить компанию"
    company: Companies @hasOne(relation: "company")
    "Получить мембера"
    member: Members @belongsTo(relation: "member")
    "Группа"
    group: Groups @belongsTo(relation: "group")
    created_at: DateTime
    updated_at: DateTime
}

extend type Query @guard {
    "Получить по ID"
    emailNotification(id: ID @eq): EmailNotification   @find
    """
    Получить список билетов
    orderBy: [
    {column: ID, order: DESC},
    ] сортировка по ID
    where:{column: SUBJECT, operator: LIKE, value: ""} фильтр по имени
    """
    emailNotifications(
        hasCompany: _ @whereHasConditions(columns: ["name"]),
        hasGroup: _ @whereHasConditions(columns: ["name"]),
        hasMember: _ @whereHasConditions(columns: ["fullname"]),
        hasTemplates: _ @whereHasConditions(columns: ["subject"]),
        created_at: DateRange @whereBetween,
        where: _ @whereConditions(columns: ["type"]),
        orderBy: _ @orderBy(
            columns: ["id"]
        )
    ): [EmailNotification!]!   @paginate(defaultCount: 10) @orderBy(column: "id", direction: ASC)
}

enum NotifyType {
    Administration @enum(value: "administration")
    Client @enum(value: "client")
}

extend type Mutation @guard {
    "Создать электронную почту"
    createEmailNotification(
        "Тип"
        type: NotifyType!
        "ID Мембера"
        member_id: ID
        "ID Группы"
        group_id: ID
        "ID компании"
        company_id: ID!
        "ID email templates"
        templates: [ID]!
    ): EmailNotification   @field(resolver:"EmailNotificationMutator@create")

    "Обновить данные компании"
    updateEmailNotification(
        id: ID!
        "Тип"
        type: NotifyType
        "ID Мембера"
        member_id: ID
        "ID Группы"
        group_id: ID
        "ID компании"
        company_id: ID
        "ID email templates"
        templates: [ID]
    ): EmailNotification   @field(resolver:"EmailNotificationMutator@update")

    "Удалить запись"
    deleteEmailNotification(
        id: ID!
    ): EmailNotification   @delete
}


